(function(){var t=function(t,s){return function(){return t.apply(s,arguments)}};window.Columnist=function(){function s(s){this.ref=s,this.onResize=t(this.onResize,this),this.onImageLoaded=t(this.onImageLoaded,this),this.cols=parseInt(this.ref.attr("data-columns"))||3,this.items=this.ref.find("div .block"),this.images=this.ref.find("img"),this.loaded=0,this.is_ready=!1,this.preloadImages()}return s.prototype.preloadImages=function(){var t,s,e,i;for(i=[],t=s=0,e=this.images.length;e>=0?e>s:s>e;t=e>=0?++s:--s)i.push(this.setPreloader($(this.images[t]).attr("src")));return i},s.prototype.setPreloader=function(t){var s;return s=new Image,s.onload=this.onImageLoaded,s.src=t},s.prototype.onImageLoaded=function(){return this.loaded++,this.loaded===this.images.length?(this.setItems(),this.is_ready=!0):void 0},s.prototype.setItems=function(){var t,s,e,i,o,n,r,h,a,d,p,u,f,m,l,c,g,I;for(d=[],o=u=0,l=this.cols;l>=0?l>u:u>l;o=l>=0?++u:--u)d.push([]);for(o=f=0,c=this.items.length;c>=0?c>f:f>c;o=c>=0?++f:--f)n=$(this.items[o]),t=Math.round(n.position().left/this.ref.width()*this.cols),d[t].push(n);for(I=[],o=m=0,g=d.length;g>=0?g>m:m>g;o=g>=0?++m:--m)i=0,p=d[o][0].position().top,I.push(function(){var t,n,u;for(u=[],a=t=1,n=d[o].length;n>=1?n>t:t>n;a=n>=1?++t:--t)r=d[o][a-1],h=d[o][a],e=i+r.height()+parseInt(r.css("margin-bottom"))+2*parseInt(r.css("border-top-width")),s=h.position().top-p-e,h.css({"margin-top":""+-s+"px"}),u.push(i=e);return u}());return I},s.prototype.onResize=function(){return this.is_ready?this.setItems():void 0},s}()}).call(this);
